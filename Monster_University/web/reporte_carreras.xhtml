<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/template.xhtml">

        <ui:define name="title">
            <h:outputText value="Reporte de Carreras" />
        </ui:define>

        <ui:define name="body">

            <h:form id="ReporteCarrerasForm">
                <!-- Mensajes de éxito/error -->
                <p:messages id="messages" showDetail="true"  closable="true" />

                <p:panel header="Reporte de Carreras">

                    <!-- ========================= -->
                    <!--        FILTROS           -->
                    <!-- ========================= -->
                    <h:panelGrid columns="5" cellpadding="7">

                        <p:outputLabel value="Nombre:" />
                        <p:inputText value="#{carreraController.filtroNombre}"
                                     style="width:200px"
                                     placeholder="Buscar por nombre" />

                        <p:outputLabel value="Créditos Mínimos:" />
                        <p:spinner value="#{carreraController.filtroMin}"
                                   style="width:180px"
                                   min="0" max="1000" />

                        <p:outputLabel value="Créditos Máximos:" />
                        <p:spinner value="#{carreraController.filtroMax}"
                                   style="width:180px"
                                   min="0" max="1000" />

                        <p:commandButton value="Buscar"
                                         icon="pi pi-search"
                                         update="tablaReporte messages"
                                         action="#{carreraController.buscar}"
                                         style="margin-top:10px" />

                        <p:commandButton value="Limpiar"
                                         icon="pi pi-refresh"
                                         update="ReporteCarrerasForm"
                                         action="#{carreraController.limpiarFiltros}"
                                         style="margin-top:10px; background-color: #f0f0f0" />

                    </h:panelGrid>

                    <br/>

                    <!-- ========================= -->
                    <!--     BOTÓN PDF            -->
                    <!-- ========================= -->
                    <h:panelGrid columns="2" style="margin-bottom: 10px;">
                        <p:commandButton id="pdfButton" 
                                         value="Descargar PDF" 
                                         icon="pi pi-file-pdf"
                                         action="#{carreraController.generarPdf}"
                                         ajax="false"
                                         styleClass="ui-button-danger"/>
                    </h:panelGrid>

                    <!-- ========================= -->
<!--        TABLA             -->
<!-- ========================= -->
<p:dataTable id="tablaReporte"
             value="#{carreraController.reportes}"
             var="carrera"
             paginator="true"
             rows="10"
             rowsPerPageTemplate="10,20,30,40,50"
             emptyMessage="No se encontraron carreras con los filtros aplicados"
             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
             currentPageReportTemplate="Mostrando {startRecord} a {endRecord} de {totalRecords} carreras">

    <!-- Cambia esta columna para mostrar el código -->
    <p:column headerText="Código" sortBy="#{carrera.codigo}" filterBy="#{carrera.codigo}">
        #{carrera.codigo}
    </p:column>

    

    <p:column headerText="Nombre" sortBy="#{carrera.nombre}" filterBy="#{carrera.nombre}">
        #{carrera.nombre}
    </p:column>

    <p:column headerText="Créditos Mínimos" sortBy="#{carrera.creditosMinimos}">
        #{carrera.creditosMinimos}
    </p:column>

    <p:column headerText="Créditos Máximos" sortBy="#{carrera.creditosMaximos}">
        #{carrera.creditosMaximos}
    </p:column>

</p:dataTable>

                </p:panel>

            </h:form>

        </ui:define>

    </ui:composition>

</html>